<html>
<header>
  <style>
    body {
      text-align: center;
    }
    canvas {
    padding-left: 0;
    padding-right: 0;
    margin-left: auto;
    margin-right: auto;
    display: block;
    width: 400px;
    }
    h1 {
      text-align: center;
    }
  </style>
</header>
<body>
  <h1> My Game! </h1>
<canvas id="the_canvas" width="400" height="400"></canvas>
<h3> Rules of the game </h3>
<ul>
  <li> Use the arrow keys to control the red square </li>
  <li> Get the square to the yellow line without
    touching any blue</li>
</ul>
<script>
  var canvas = document.getElementById('the_canvas');
  var ctx = canvas.getContext('2d');

  // sets the speed of the box by setting how many pixels
  // the player box moves everytime a button is pressed
  var speed = 6;

  // updates the position of player box when arrow
  // keys are pressed
  var handleKeyDown = function(evt) {
    if (evt.keyCode === 39) {
      //Left arrow was pressed
      x+=speed;
    } else if (evt.keyCode === 37) {
      //Left arrow was pressed
      x-=speed;
    }else if (evt.keyCode === 40){
      // down key pressed
      y+=speed;
      // up key pressed
    }else if (evt.keyCode === 38){
      y-=speed;
    }

  }
  window.addEventListener('keydown',handleKeyDown,true);

  // initialize x-axis and y-axis variable for player square
  var x = 190;
  var y = 0;

  // intialize the starting x and y of single original block
  var z = 0;
  var a = 200;

  // initialize win counter
  var win = 0;

  //create array for the height of each line
  var height = [100, 200, 300, 70, 135, 230];

  // create array for the x value of each block in each line
  var a = [0, 100, 200, 300];
  var b = [50, 150, 250, 350];
  var c = [50, 100, 200, 250, 350];
  var d = [160, 180, 200, 220, 240, 260, 280, 300, 320, 340, 360, 380];
  var e = [0, 20, 40, 60, 80, 100, 120, 140, 160, 180, 200, 220, 240]
  var f = [160, 180, 200, 220, 240, 260, 280, 300, 320, 340, 360, 380];
  var all = [a, b, c, d, e, f];

  // resets board with updated values
  var draw = function() {
    //clear background
    ctx.fillStyle = "gray";
    ctx.fillRect(0,0, canvas.width, canvas.height);
    ctx.fillStyle = "yellow";
    ctx.fillRect(0, 380, 400, 20);
    //make sure player doesn't go off the screen
    if (x > (canvas.width - 20)) {
      x %= canvas.width;
      x = canvas.width-20;
    }
    if(x <= 0){
      x = 0;
    }
    if (y > (canvas.width - 20)) {
      y %= canvas.width;
      y = 0;
      win++;
    }
    if(y <= 0){
      y = 0;
    }

    /*
    // updates all lines
    for (var i = 0; i < all.length; i++) {
      for (var count = 0; count < all[i].length; count++) {
        if (i%2 === 0){
          all[i][count]++;
          if (all[i][count] > canvas.width) {
            all[i][count] %= canvas.width;
            all[i][count] = 0;
          }
        } else{
            all[i][count]--;
            if(all[i][count] + 20 < 0){
              all[i][count] = canvas.width -20; 
            }
          }
      }
    };
    */

    // updates first line
    for (var i = 0; i < a.length; i++) {
      a[i]++;
      if (a[i] > canvas.width) {
        a[i] %= canvas.width;
        a[i] = 0;
      }
    };

    //updates 2nd line
    for (var i = 0; i < b.length; i++) {
      b[i]-=3;
      if(b[i] + 20 < 0){
        b[i] = canvas.width -20;      
      }
    };

    //updates 3rd line
    for (var i = 0; i < c.length; i++) {
      c[i]+=2;
      if (c[i] > canvas.width) {
        c[i] %= canvas.width;
        c[i] = 0;
      }
    };

    //draw player in new position
    ctx.fillStyle = "red";
    ctx.fillRect (x, y, 20, 20);

    // draws each line
    ctx.fillStyle = "blue";
    for (var i = 0; i < all.length; i++) {
      for (var count = 0; count < all[i].length; count++) {
        ctx.fillRect(all[i][count], height[i], 20, 20)
      };
    };



    // draws original square
    ctx.fillStyle = "blue";
    //ctx.fillRect(z, a[2], 20, 20);

     // collision detection:
     //  all[i][count] = x corners
     //  height[i] = y corners
     for (var i = 0; i < all.length; i++) {
      for (var count = 0; count < all[i].length; count++) {
        if( (y>=height[i]) && (y<=height[i]+20) && (x >= all[i][count]) && (x <= all[i][count]+20) ||
          (y+20>=height[i]) && (y+20<=height[i]+20) && (x >= all[i][count]) && (x <= all[i][count]+20) ||
          (y>=height[i]) && (y<=height[i]+20) && (x+20 >= all[i][count]) && (x+20 <= all[i][count]+20) ||
          (y+20>=height[i]) && (y+20<=height[i]+20) && (x+20 >= all[i][count]) && (x+20 <= all[i][count]+20) ){
          x=190;
          y=0;
          win--;
        }
      };
    };

    // draws the amount of wins
    ctx.font = '10pt Calibri';
    var message = "Wins: " + win;
    ctx.fillText(message, 5, 15);
  }

  setInterval(draw, 20);
</script>
</body>
</html>